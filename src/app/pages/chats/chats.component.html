<div class="flex min-h-screen">
  <!-- Left: Users / Chats list -->
  <aside
    class="w-1/4 h-screen bg-customColor-sideBackground p-4 flex flex-column gap-4"
  >
    <div class="search-filter-container">
      <app-search-input (search)="handleSearch($event)"></app-search-input>
    </div>

    <div class="users-container flex-1 overflow-auto flex flex-column gap-3">
      <ng-container *ngFor="let item of userChats; let i = index">
        <div class="p-shadow-1 p-p-2 rounded-md">
          <app-user-chat-card [config]="item"></app-user-chat-card>
        </div>
      </ng-container>
    </div>

    <button
      pButton
      type="button"
      label="Log out"
      class="p-button-danger w-full"
      (click)="authService.logoutUser()"
    ></button>
  </aside>

  <!-- Right: Chat detail -->
  <section class="flex-1 flex flex-column bg-customColor-greyish">
    <ng-container *ngIf="senderUser; else emptyState">
      <header class="p-d-flex p-ai-center p-p-3 gap-3 border-bottom">
        <img
          [src]="senderUser.profile"
          alt="sender profile"
          class="w-3rem h-3rem rounded-full"
        />
        <div class="flex flex-column">
          <span *ngIf="senderUser.fullName" class="font-bold text-xl">{{
            senderUser.fullName
          }}</span>
          <small class="text-color-secondary">{{ senderUser.userId }}</small>
        </div>
      </header>

      <div class="messages-container flex-1 overflow-auto p-4">
        <div class="message-list flex flex-column gap-3">
          <ng-container *ngFor="let item of chats; let j = index">
            <app-chat-bubble [config]="item"></app-chat-bubble>
          </ng-container>
        </div>
      </div>

      <div class="p-p-3 bg-customColor-bubbleBackground">
        <div class="flex align-items-center gap-3">
          <input
            pInputText
            [formControl]="messageControl"
            type="text"
            placeholder="Say something.."
            class="flex-1"
          />
          <button
            pButton
            type="button"
            icon="pi pi-send"
            class="p-button-rounded p-button-primary"
            (click)="addMessage()"
          ></button>
        </div>
      </div>
    </ng-container>

    <ng-template #emptyState>
      <div class="flex-1 flex align-items-center justify-content-center">
        <div class="text-center text-color-secondary">
          Select a chat to start messaging
        </div>
      </div>
    </ng-template>
  </section>
</div>
